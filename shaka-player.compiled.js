(function(){var g={};
(function(window){var k,aa=this;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Tb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Rb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(){};function ca(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}ca("error");ca("warn");ca("info");ca("log");ca("debug");function da(a){ea[a]={ma:fa(),end:NaN}}function ga(a){if(a=ea[a])a.end=fa()}function ha(a){return(a=ea[a])&&a.end?a.end-a.ma:NaN}var fa=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,ea={};function ia(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}p("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function ja(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}ja.prototype.clone=function(){var a=new ja;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function r(){this.fontSize="100%";this.fontColor=ka;this.fontOpacity=la;this.backgroundColor=ma;this.backgroundOpacity=la;this.fontEdge=na}p("shaka.player.TextStyle",r);r.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};r.prototype.load=r.prototype.a;r.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
r.prototype.store=r.prototype.b;function oa(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+pa(a.fontColor,a.fontOpacity));b.push("background-color: "+pa(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(pa(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function pa(a,b){return"rgba("+a.concat(b).join(",")+")"}var ka=[255,255,255],ma=[0,0,0];
r.StandardColors={WHITE:ka,BLACK:ma,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var la=1;r.StandardOpacities={OPAQUE:la,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var na=[];
r.EdgeStyles={NONE:na,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function qa(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}p("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ra(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function sa(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}p("shaka.player.VideoTrack.compare",sa);function ua(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=va)}p("shaka.polyfill.CustomEvent.install",ua);function va(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function wa(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
xa);document.addEventListener("webkitfullscreenerror",xa);document.addEventListener("mozfullscreenchange",xa);document.addEventListener("mozfullscreenerror",xa);document.addEventListener("MSFullscreenChange",xa);document.addEventListener("MSFullscreenError",xa)}p("shaka.polyfill.Fullscreen.install",wa);function xa(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function ya(){return Promise.reject(Error("The key system specified is not supported."))}function za(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Aa(){throw new TypeError("Illegal constructor.");}Aa.prototype.createSession=function(){};Aa.prototype.setServerCertificate=function(){};function Ba(){throw new TypeError("Illegal constructor.");}Ba.prototype.getConfiguration=function(){};Ba.prototype.createMediaKeys=function(){};function Ca(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=Da)}p("shaka.polyfill.VideoPlaybackQuality.install",Ca);function Da(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function Ea(a,b){for(var c=[],d=0;d<a.length;++d){for(var e=!1,f=0;f<c.length&&!(e=b?b(a[d],c[f]):a[d]===c[f]);++f);e||c.push(a[d])}return c};function w(){return Date.now()+Fa}var Fa=0;function Ga(a){this.b=a;this.c=0==Ha;this.a=0}var Ha=1;function Ja(a){return a.a<a.b.byteLength}function Ka(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function x(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function La(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Ma(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function y(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function Na(a){this.b=a;this.a=new Ga(a);Oa||(Oa=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var Oa;
function z(a){var b;b=Pa(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=Pa(a);a:{for(d=0;d<Oa.length;d++)if(Qa(c,Oa[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;c=
a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,a.b.byteOffset+a.a.a,c);y(a.a,c);return new Ra(b,d)}function Pa(a){var b=Ka(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=Ka(a.a);return d}function Ra(a,b){this.id=a;this.a=b}
function Sa(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};var Ta={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function Ua(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}Ua.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function Va(a){return a.b/(1-Math.pow(a.c,a.a))};function A(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function B(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function Wa(a,b,c){Xa(b);Xa(c);return c==b||a>=Ya&&c==b.split("-")[0]||a>=Za&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Ya=1,Za=2;function Xa(a){a=a.toLowerCase().split("-");var b=$a[a[0]];b&&(a[0]=b);return a.join("-")}
var $a={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function ab(a){return Object.keys(a).map(function(b){return a[b]})}function bb(a,b){var c=cb(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function db(a,b){return cb(a,b,"string")}function cb(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}
function eb(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function D(){this.a={}}D.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};D.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function fb(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function gb(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function hb(a){var b=[],c;for(c in a.a)b.push(c);return b};function ib(){this.a=new D}ib.prototype.destroy=function(){jb(this);this.a=null};function E(a,b,c,d){b=new kb(b,c,d);a.a.push(c,b)}ib.prototype.ra=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.ra(),gb(this.a,b,e))}};function jb(a){for(var b=fb(a.a),c=0;c<b.length;++c)b[c].ra();a.a.a={}}function kb(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
kb.prototype.ra=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function F(a){this.wa=new D;this.v=a}p("shaka.util.FakeEventTarget",F);F.prototype.addEventListener=function(a,b,c){c||this.wa.push(a,b)};F.prototype.removeEventListener=function(a,b,c){c||gb(this.wa,a,b)};F.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return lb(this,a)};
function lb(a,b){b.currentTarget=a;for(var c=a.wa.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.v&&b.bubbles&&lb(a.v,b);return b.defaultPrevented};function mb(){F.call(this,null);this.a=new Ua(3);this.c=new Ua(10);this.b=0}q(mb,F);p("shaka.util.EWMABandwidthEstimator",mb);mb.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(A({type:"bandwidth"}));this.b=Date.now()}};mb.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(Va(this.a),Va(this.c))};mb.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
mb.prototype.supportsCaching=function(){return!1};function G(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=G.prototype.destroy;return c}G.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function nb(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function ob(){this.g=new G;this.f=!1;this.a=null;this.b=[];this.c=null}function pb(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}ob.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});qb(this,void 0)};ob.prototype.end=function(){this.b.splice(1)};
function qb(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(H(a,function(a){this.a?(this.b=[],this.c=null,rb(this)):(this.b.shift(),this.b.length?qb(this,a):(this.g.resolve(a),this.c=null))})).catch(H(a,function(a){this.b=[];this.c=null;this.a?rb(this):this.g.reject(a)}))}function rb(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function H(a,b){return b.bind(a)};function sb(a,b){F.call(this,b);this.a=null;this.h=a}q(sb,F);
function tb(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),a.type="storage",Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),a.type="storage",Promise.reject(a);var b=new G,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=H(a,function(a){this.a=a.target.result;ub(this,"group_store",{keyPath:"group_id"});ub(this,"stream_index_store",{keyPath:"stream_id"});a=ub(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",
["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=H(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function I(a){a.a&&(a.a.close(),a.a=null)}function ub(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function vb(a){return wb(a,"content_store")}function xb(a){return wb(a,"stream_index_store")}function yb(a){return wb(a,"group_store")}
function wb(a,b){return a.a.transaction([b],a.h).objectStore(b)}function zb(a,b){var c=new G,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function Ab(){sb.call(this,"readonly",null)}q(Ab,sb);function Bb(a){var b=new G,c=[],d=yb(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Cb(a,b){return zb(yb(a),b).then(H(a,function(a){a.session_ids=Ea(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Eb(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;a.license_server=b.license_server;a.with_credentials=b.with_credentials;a.distinctive_identifier=b.distinctive_identifier;a.audio_robustness=b.audio_robustness;a.video_robustness=b.video_robustness;return Promise.resolve(a)})}))}
function Eb(a,b){return zb(xb(a),b)}function Fb(a,b,c){return zb(vb(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function Gb(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.v=a;this.c=b;this.l=c;this.i=new ib;this.g=null;this.b=[];this.w=0;this.f=this.a=null;this.s=0;E(this.i,this.c,"updateend",this.B.bind(this))}var Hb=1/60;Gb.prototype.destroy=function(){Ib(this).catch(function(){});this.f&&this.f.destroy();this.a=this.f=null;this.g&&(I(this.g),this.g=null);this.b=null;this.i.destroy();this.v=this.c=this.i=null};
function Jb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-Hb,f=c.end(d)+Hb;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function Kb(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.j+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new ob;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);"idb"!=b.url.b[0].P||a.g||(a.g=new Ab,pb(a.a,function(){return[tb(this.g)]}.bind(a)));d&&pb(a.a,function(){return[Lb(this,d),this.h.bind(this)]}.bind(a));pb(a.a,function(){var a=b.a?b.a-b.b:1,c=new Mb;c.a=3;c.h=1E3*a;c.c=1E3*this.s;c.i=this.g;return[Nb(b.url,c,this.l),J.prototype.g.bind(b.url)]}.bind(a));
pb(a.a,H(a,function(a){this.l.getBandwidth();return[Lb(this,a),this.h.bind(this)]}));var e=0==a.c.buffered.length&&0==a.b.length,f=null;pb(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.j+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=Ob(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return Pb(a).then(function(){return Promise.resolve(f)}.bind(a))}
function Qb(a){if(a.a)return a=Error("Cannot clear ("+a.j+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new ob;pb(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new G}return[a,this.h.bind(this)]}.bind(a));return Pb(a)}
function Rb(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.j+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new ob;pb(a.a,function(){return[Sb(this,b),this.h.bind(this)]}.bind(a));return Pb(a)}function Ib(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new G,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function Pb(a){a.a.start();return a.a.g.then(H(a,function(){this.a=null})).catch(H(a,function(a){this.a=null;return Promise.reject(a)}))}
function Lb(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new G;return a.f}function Sb(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=Ob(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,Number.POSITIVE_INFINITY)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new G;return a.f}Gb.prototype.h=function(){"open"==this.v.readyState&&this.c.abort()};Gb.prototype.B=function(){this.f.resolve();this.f=null};function Tb(a){return String.fromCharCode.apply(null,a)}p("shaka.util.Uint8ArrayUtils.toString",Tb);function Ub(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}p("shaka.util.Uint8ArrayUtils.fromString",Ub);p("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(Tb(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function Vb(a){return Ub(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
p("shaka.util.Uint8ArrayUtils.fromBase64",Vb);p("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function Wb(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}p("shaka.util.Uint8ArrayUtils.toHex",Wb);function Qa(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function Xb(){this.j=this.a="";this.v=!1;this.i=this.h=null;this.s=this.g=!1;this.l=this.f="";this.c=null;this.b=[]}
function Yb(a){var b=new Xb;if(!a)return b;var c=db(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=db(a,"licenseServerUrl");if(null!=d)b.j=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=cb(a,"withCredentials","boolean");null!=c&&(b.v=c);c=eb(a,"licensePostProcessor",Function);null!=c&&(b.h=c);c=eb(a,"licensePreProcessor",Function);null!=c&&(b.i=c);c=cb(a,"distinctiveIdentifierRequired","boolean");null!=
c&&(b.g=c);c=cb(a,"persistentStateRequired","boolean");null!=c&&(b.s=c);c=db(a,"audioRobustness");null!=c&&(b.f=c);c=db(a,"videoRobustness");null!=c&&(b.l=c);c=eb(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=eb(a,"initData",Object)){a=eb(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=db(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function Zb(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=Ea(c,$b)}function $b(a,b){return a.initDataType==b.initDataType&&Qa(a.initData,b.initData)};function ac(a,b){try{var c=new bc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function cc(a){var b=this.mediaKeys;b&&b!=a&&dc(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&dc(a,this);return Promise.resolve()}
function bc(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},l=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var n=g.audioCapabilities[m];
n.contentType&&(l=!0,e.canPlayType(n.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(n),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)n=g.videoCapabilities[m],n.contentType&&(l=!0,e.canPlayType(n.contentType,this.a)&&(h.videoCapabilities.push(n),d=!0));l||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}throw Error("None of the requested configurations were supported.");
}bc.prototype.createMediaKeys=function(){var a=new ec(this.a);return Promise.resolve(a)};bc.prototype.getConfiguration=function(){return this.b};function ec(a){this.g=a;this.b=null;this.a=new ib;this.c=[];this.f={}}function dc(a,b){a.b=b;jb(a.a);b&&(E(a.a,b,"webkitneedkey",a.Gb.bind(a)),E(a.a,b,"webkitkeymessage",a.Fb.bind(a)),E(a.a,b,"webkitkeyadded",a.Db.bind(a)),E(a.a,b,"webkitkeyerror",a.Eb.bind(a)))}k=ec.prototype;
k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new fc(a,this.g,b);this.c.push(b);return b};k.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};k.Gb=function(a){a=A({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};
k.Fb=function(a){var b=gc(this,a.sessionId);b&&(a=A({type:"message",messageType:void 0==b.keyStatuses.a?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};k.Db=function(a){if(a=gc(this,a.sessionId))hc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
k.Eb=function(a){var b=gc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?hc(b,"output-restricted"):1==c?hc(b,"expired"):hc(b,"internal-error"))}};
function gc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function fc(a,b,c){F.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new G;this.keyStatuses=new ic}q(fc,F);
function jc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=Ub("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=Ub("PERSISTENT|"+Tb(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new G;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}k=fc.prototype;k.Ja=function(a,b){if(this.a)this.a.then(this.Ja.bind(this,a,b)).catch(this.Ja.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=Tb(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=Vb(d.keys[0].k),d=Vb(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function hc(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.a=b;c=A({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return jc(this,b,null)};k.load=function(a){return"persistent-license"==this.g?jc(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new G;this.Ja(b,a);return b};
k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function kc(a){this.b=a;this.a=0}
kc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function ic(){this.size=0;this.a=void 0}var lc;k=ic.prototype;k.entries=function(){var a=lc,b=[];this.a&&b.push([a,this.a]);return new kc(b)};k.forEach=function(a){this.a&&a(this.a)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=lc;return this.a&&Qa(new Uint8Array(a),b)?!0:!1};k.keys=function(){var a=lc,b=[];this.a&&b.push(a);return new kc(b)};
k.values=function(){var a=[];this.a&&a.push(this.a);return new kc(a)};function mc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(lc=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=ac,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=cc,window.MediaKeys=ec,window.MediaKeySystemAccess=bc):(Navigator.prototype.requestMediaKeySystemAccess=ya,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=za,window.MediaKeys=Aa,window.MediaKeySystemAccess=Ba))}p("shaka.polyfill.MediaKeys.install",mc);p("shaka.polyfill.installAll",function(){ua();wa();mc();Ca()});function nc(a){this.systemIds=[];this.cencKeyIds=[];a=new Ga(new DataView(a.buffer));try{for(;Ja(a);){var b=a.a,c=x(a),d=x(a);1==c?c=La(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)y(a,c-(a.a-b));else{var e=Ka(a);if(1<e)y(a,c-(a.a-b));else{y(a,3);var f=Wb(Ma(a)),g=[];if(0<e)for(var h=x(a),l=0;l<h;++l){var m=Wb(Ma(a));g.push(m)}var n=x(a);y(a,n);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.a!=b+c&&y(a,c-(a.a-b))}}}}catch(t){}};var oc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function K(a){var b;a instanceof K?(pc(this,a.P),this.ba=a.ba,this.R=a.R,qc(this,a.ha),this.O=a.O,rc(this,a.a.clone()),this.aa=a.aa):a&&(b=String(a).match(oc))?(pc(this,b[1]||"",!0),this.ba=sc(b[2]||""),this.R=sc(b[3]||"",!0),qc(this,b[4]),this.O=sc(b[5]||"",!0),rc(this,b[6]||"",!0),this.aa=sc(b[7]||"")):this.a=new tc(null)}k=K.prototype;k.P="";k.ba="";k.R="";k.ha=null;k.O="";k.aa="";
k.toString=function(){var a=[],b=this.P;b&&a.push(uc(b,vc,!0),":");if(b=this.R){a.push("//");var c=this.ba;c&&a.push(uc(c,vc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.ha;null!=b&&a.push(":",String(b))}if(b=this.O)this.R&&"/"!=b.charAt(0)&&a.push("/"),a.push(uc(b,"/"==b.charAt(0)?wc:xc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.aa)&&a.push("#",uc(b,yc));return a.join("")};
k.resolve=function(a){var b=this.clone();"data"===b.P&&(b=new K);var c=!!a.P;c?pc(b,a.P):c=!!a.ba;c?b.ba=a.ba:c=!!a.R;c?b.R=a.R:c=null!=a.ha;var d=a.O;if(c)qc(b,a.ha);else if(c=!!a.O){if("/"!=d.charAt(0))if(this.R&&!this.O)d="/"+d;else{var e=b.O.lastIndexOf("/");-1!=e&&(d=b.O.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.O=d:c=""!==a.a.toString();c?rc(b,a.a.clone()):c=!!a.aa;c&&(b.aa=a.aa);return b};k.clone=function(){return new K(this)};function pc(a,b,c){a.P=c?sc(b,!0):b;a.P&&(a.P=a.P.replace(/:$/,""))}function qc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.ha=b}else a.ha=null}function rc(a,b,c){b instanceof tc?a.a=b:(c||(b=uc(b,zc)),a.a=new tc(b))}
function sc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function uc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Ac),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ac(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var vc=/[#\/\?@]/g,xc=/[\#\?:]/g,wc=/[\#\?]/g,zc=/[\#\?@]/g,yc=/#/g;function tc(a){this.b=a||null}tc.prototype.a=null;tc.prototype.c=null;
function Bc(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";Bc(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
tc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};tc.prototype.clone=function(){var a=new tc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function Cc(){this.id=this.url=null;this.type="static";this.b=this.j=this.u=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[]}function Dc(){this.g=this.f=this.c=this.u=this.a=this.start=this.id=null;this.b=[]}function Ec(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.u=null;this.j=[];this.a=[]}function Fc(){this.value=null}function Gc(){this.contentType=this.lang=this.id=null}
function Hc(){this.a=this.b=this.g=this.u=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function Jc(){this.b=this.a=this.c=this.f=null}function Kc(){this.parsedPssh=this.psshBox=null}function Lc(){this.url=null}function Mc(){this.url=null}function Nc(){this.u=null;this.g=1;this.c=this.b=this.a=this.f=null}Nc.prototype.clone=function(){var a=new Nc;a.u=Oc(this.u);a.g=this.g;a.f=this.f;a.a=L(this.a);a.b=L(this.b);a.c=L(this.c);return a};
function Pc(){this.a=this.url=null}Pc.prototype.clone=function(){var a=new Pc;a.url=Oc(this.url);a.a=L(this.a);return a};function Qc(){this.a=this.url=null}Qc.prototype.clone=function(){var a=new Qc;a.url=Oc(this.url);a.a=L(this.a);return a};function Rc(){this.u=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}Rc.prototype.clone=function(){var a=new Rc;a.u=Oc(this.u);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=L(this.h);a.a=Oc(this.a)||[];a.c=L(this.c);return a};
function Sc(){this.a=this.b=null}Sc.prototype.clone=function(){var a=new Sc;a.b=Oc(this.b);a.a=L(this.a);return a};function Tc(){this.b=1;this.a=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}Tc.prototype.clone=function(){var a=new Tc;a.b=this.b;a.i=this.i;a.a=this.a;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=L(this.c);return a};function Uc(){this.a=[]}Uc.prototype.clone=function(){var a=new Uc;a.a=Oc(this.a)||[];return a};function Vc(){this.c=this.a=this.b=null}
Vc.prototype.clone=function(){var a=new Vc;a.b=this.b;a.a=this.a;a.c=this.c;return a};function Wc(a,b){this.ma=a;this.end=b}Wc.prototype.clone=function(){return new Wc(this.ma,this.end)};Cc.TAG_NAME="MPD";Dc.TAG_NAME="Period";Ec.TAG_NAME="AdaptationSet";Fc.TAG_NAME="Role";Gc.TAG_NAME="ContentComponent";Hc.TAG_NAME="Representation";Jc.TAG_NAME="ContentProtection";Kc.TAG_NAME="cenc:pssh";Lc.TAG_NAME="BaseURL";Mc.TAG_NAME="Location";Nc.TAG_NAME="SegmentBase";Pc.TAG_NAME="RepresentationIndex";
Qc.TAG_NAME="Initialization";Rc.TAG_NAME="SegmentList";Sc.TAG_NAME="SegmentURL";Tc.TAG_NAME="SegmentTemplate";Uc.TAG_NAME="SegmentTimeline";Vc.TAG_NAME="S";
Cc.prototype.parse=function(a,b){this.url=a.u;this.id=M(b,"id",N);this.type=M(b,"type",N)||"static";this.b=M(b,"mediaPresentationDuration",Xc);this.h=M(b,"minBufferTime",Xc,this.h);this.g=M(b,"minimumUpdatePeriod",Xc,this.g);this.c=M(b,"availabilityStartTime",Yc,this.c);this.f=M(b,"timeShiftBufferDepth",Xc,this.f);this.i=M(b,"suggestedPresentationDelay",Xc,this.i);var c=a.u,d=O(this,b,Lc);this.u=Zc(c,d);if(d=P(this,b,Mc))this.j=$c(c,d.url);this.a=O(this,b,Dc)};
Dc.prototype.parse=function(a,b){this.id=M(b,"id",N);this.start=M(b,"start",Xc);this.a=M(b,"duration",Xc);var c=O(this,b,Lc);this.u=Zc(a.u,c);this.c=P(this,b,Nc);this.f=P(this,b,Rc);this.g=P(this,b,Tc);this.b=O(this,b,Ec);ad(this)};function ad(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
Ec.prototype.parse=function(a,b){var c=P(this,b,Gc)||{},d=P(this,b,Fc);this.id=M(b,"id",N);this.group=M(b,"group",Q);this.lang=M(b,"lang",N,c.lang);this.contentType=M(b,"contentType",N,c.contentType);this.width=M(b,"width",R);this.height=M(b,"height",R);this.b=M(b,"mimeType",N);this.i=M(b,"codecs",N);this.c=d&&"main"==d.value;this.lang&&(this.lang=Xa(this.lang));c=O(this,b,Lc);this.u=Zc(a.u,c);this.j=O(this,b,Jc);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?bd(this,
b,a.c):P(this,b,Nc);this.g=a.f?bd(this,b,a.f):P(this,b,Rc);this.h=a.g?bd(this,b,a.g):P(this,b,Tc);this.a=O(this,b,Hc);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};Fc.prototype.parse=function(a,b){this.value=M(b,"value",N)};Gc.prototype.parse=function(a,b){this.id=M(b,"id",N);this.lang=M(b,"lang",N);this.contentType=M(b,"contentType",N);this.lang&&(this.lang=Xa(this.lang))};
Hc.prototype.parse=function(a,b){this.id=M(b,"id",N);this.bandwidth=M(b,"bandwidth",R);this.width=M(b,"width",R,a.width);this.height=M(b,"height",R,a.height);this.f=M(b,"mimeType",N,a.b);this.h=M(b,"codecs",N,a.i);this.lang=a.lang;var c=O(this,b,Lc);this.u=Zc(a.u,c);this.c=O(this,b,Jc);this.g=a.f?bd(this,b,a.f):P(this,b,Nc);this.b=a.g?bd(this,b,a.g):P(this,b,Rc);this.a=a.h?bd(this,b,a.h):P(this,b,Tc);0==this.c.length&&(this.c=a.j)};
Jc.prototype.parse=function(a,b){this.f=b;this.c=M(b,"schemeIdUri",N);var c=M(b,"cenc:default_KID",N);c&&(this.b=c.replace(/[-]/g,""));this.a=P(this,b,Kc)};Kc.prototype.parse=function(a,b){var c=cd(b);if(c){this.psshBox=Vb(c);try{this.parsedPssh=new nc(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};Lc.prototype.parse=function(a,b){this.url=cd(b)};Mc.prototype.parse=function(a,b){this.url=cd(b)};
Nc.prototype.parse=function(a,b){this.u=a.u||this.u;this.g=M(b,"timescale",R,this.g);this.f=M(b,"presentationTimeOffset",Q,this.f);this.a=M(b,"indexRange",dd,this.a);this.b=P(this,b,Pc)||this.b;this.c=P(this,b,Qc)||this.c};Pc.prototype.parse=function(a,b){var c=M(b,"sourceURL",N);this.url=$c(a.u,c);this.a=M(b,"range",dd,L(a.a))};Qc.prototype.parse=function(a,b){var c=M(b,"sourceURL",N);this.url=$c(a.u,c);this.a=M(b,"range",dd)};
Rc.prototype.parse=function(a,b){this.u=a.u||this.u;this.f=M(b,"timescale",R,this.f);this.g=M(b,"presentationTimeOffset",Q,this.g);this.b=M(b,"duration",R,this.b);this.i=M(b,"startNumber",Q,this.i);this.h=P(this,b,Qc)||this.h;var c=O(this,b,Sc);this.a=c&&0<c.length?c:this.a;this.c=P(this,b,Uc)||this.c};Sc.prototype.parse=function(a,b){var c=M(b,"media",N);this.b=$c(a.u,c);this.a=M(b,"mediaRange",dd)};
Tc.prototype.parse=function(a,b){this.b=M(b,"timescale",R,this.b);this.i=M(b,"presentationTimeOffset",Q,this.i);this.a=M(b,"duration",R,this.a);this.j=M(b,"startNumber",Q,this.j);this.h=M(b,"media",N,this.h);this.f=M(b,"index",N,this.f);this.g=M(b,"initialization",N,this.g);this.c=P(this,b,Uc)||this.c};Uc.prototype.parse=function(a,b){this.a=O(this,b,Vc)};Vc.prototype.parse=function(a,b){this.b=M(b,"t",Q);this.a=M(b,"d",Q);this.c=M(b,"r",ed)};
function Zc(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new K(e)):(e=$c(a.slice(0,1),e),c.push(e[0]))}return c}function $c(a,b){if(!b)return a;var c=new K(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function bd(a,b,c){var d=L(c);(b=fd(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function P(a,b,c){var d=null;if(b=fd(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function fd(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function O(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function cd(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function Oc(a){return a?a.map(function(a){return a.clone()}):null}function L(a){return a?a.clone():null}
function M(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function Yc(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function Xc(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=Q(b[1]);c&&(a+=31536E3*c);(c=Q(b[2]))&&(a+=2592E3*c);(c=Q(b[3]))&&(a+=86400*c);(c=Q(b[4]))&&(a+=3600*c);(c=Q(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function dd(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=Q(b[1]);if(null==a)return null;b=Q(b[2]);return null==b?null:new Wc(a,b)}function ed(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function R(a){a=window.parseInt(a,10);return 0<a?a:null}function Q(a){a=window.parseInt(a,10);return 0<=a?a:null}function N(a){return a};function gd(a,b){this.url=a;this.b=b||new Mb;this.g=this.i=this.h=0;this.a=null;this.c=new G;this.f=null}function Mb(){this.body=null;this.a=1;this.h=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.g=this.j=!1;this.i=null}function hd(a){id(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function id(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}k=gd.prototype;
k.jb=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=Ub(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);hd(this);return b}if(0==this.url.lastIndexOf("idb:",0))return jd(this);this.h++;this.i=Date.now();this.g||
(this.g=this.b.h);this.a=new XMLHttpRequest;a=this.url;if(this.f&&!this.f.supportsCaching()||this.b.g)a=new K(a),Bc(a.a,"_",Date.now()),a=a.toString();this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.j;this.a.onload=this.rb.bind(this);this.b.g&&(this.a.onreadystatechange=this.vb.bind(this));this.a.onerror=this.Mb.bind(this);this.a.ontimeout=this.Ab.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);
return this.c};function jd(a){var b=a.url.split("/");return Fb(a.b.i,parseInt(b[2],10),parseInt(b[3],10)).then(H(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);hd(this);return a})).catch(H(a,function(a){hd(this);return Promise.reject(a)}))}function kd(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.Qb=a.a;return b}
k.rb=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),hd(this)):this.h<this.b.a?ld(this):(a=kd(this,"HTTP error.","net"),this.c.reject(a),hd(this))};k.vb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(Fa=a-Date.now())}};k.Mb=function(){var a=kd(this,"Network failure.","net");this.c.reject(a);hd(this)};
k.Ab=function(){if(this.h<this.b.a)ld(this);else{var a=kd(this,"Request timed out.","net");this.c.reject(a);hd(this)}};function ld(a){id(a);window.setTimeout(a.jb.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function J(a,b,c,d){this.b=b;this.f=c||0;this.h=null!=d?d:null;this.c=this.a=null;this.i=a}function md(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function Nb(a,b,c){if(a.a)return a.a;b=b||new Mb;if(a.f||a.h)b.b.Range="bytes="+(a.f+"-"+(null!=a.h?a.h:""));a.a=nd(a,0,b,c);return a.a}J.prototype.g=function(){if(this.c){this.a=null;var a=this.c;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=kd(a,"Request aborted.","aborted");a.c.reject(b);hd(a)}this.c=null}};
function nd(a,b,c,d){var e=a.b[b].toString();a.i&&(e=a.i(e,c.b)||e);a.c=new gd(e,c);d&&(a.c.f=d);e=a.c.jb().then(H(a,function(a){this.c=this.a=null;return Promise.resolve(a.response)}));return e=e.catch(H(a,function(a){if(this.a&&b+1<this.b.length)return this.a=nd(this,b+1,c,d);this.a=this.c=null;return Promise.reject(a)}))}J.prototype.clone=function(){return new J(this.i,this.b.map(function(a){return a.clone()}),this.f,this.h)};J.prototype.toString=function(){return this.b[0].toString()};function od(a,b){this.a=new Mb;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.g=!0;this.b=a}function pd(a){var b=a.b;return Nb(b,a.a).then(function(a){var d;d=b.b;d=(a=(new DOMParser).parseFromString(a,"text/xml"))?P({u:d},a,Cc):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="dash";return Promise.reject(d)})};function qd(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,l=(h-1)*e.a,m=l/e.b,l=(l+e.a)/e.b,h=rd(a,b,h-1+e.j,(h-1)*e.a);if(!h)return null;f.push(new sd(m,l,h))}return f}function rd(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.u?new J(a,b.u,0,null):null;c=td(e,b.id,c,b.bandwidth,d);if(!c)return null;b=md(b.u,c);return new J(a,b,0,null)}
function td(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new K(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function ud(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].b,f=null!=f?f:d,g=a[e].c||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].b+b-f)/g)-1:Math.ceil((a[e+1].b-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function vd(a,b){this.a=a;this.b=b||null}vd.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null);this.b=null};vd.prototype.create=function(){return this.a?Nb(this.a):Promise.resolve(this.b)};function sd(a,b,c){this.b=a;this.a=b;this.url=c}function wd(a,b,c){return new sd(b,c,a.url)}function Ob(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function xd(a,b){return a.map(function(a){return wd(a,a.b+b,null!=a.a?a.a+b:null)})};function yd(){}
yd.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new Ga(a),h=x(g);if(1936286840!=x(g))e=null;else{1==h&&(h=La(g));var l=Ka(g);y(g,3);y(g,4);var m=x(g);if(0==m)e=null;else{var n,t;0==l?(n=x(g),t=x(g)):(n=La(g),t=La(g));y(g,2);var C=g.b.getUint16(g.a,g.c);g.a+=2;a=n;b=b+h+t;for(h=0;h<C;h++){var u=x(g);t=(u&2147483648)>>>31;var l=u&2147483647,v=x(g);x(g);if(1==t){e=null;break a}var ta=new J(d,c,b,b+l-1);f.push(new sd(a/m,(a+v)/m,ta));a+=v;b+=l}e=f}}}}catch(Db){if(!(Db instanceof RangeError))throw Db;
}return e};function S(a){this.o=a;this.i=0}S.prototype.destroy=function(){this.o=null};k=S.prototype;k.length=function(){return this.o.length};function T(a){if(0==a.o.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.o[0]}k.A=function(){if(0==this.o.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.o[this.o.length-1]};
k.get=function(a){if(0>a||a>=this.o.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.o[a]};k.ka=function(a){a=Ob(this.o,a);return 0<=a?this.o[a]:null};k.Da=function(a){zd(this,a);return!0};
function zd(a,b){a.i!=b.i&&(b=new S(xd(b.o,a.i-b.i)));if(0==a.length())a.o=b.o.slice(0);else if(0!=b.length()&&null!=a.A().a&&!(null!=b.A().a&&b.A().a<a.A().a)){if(a.A().a<=T(b).b)var c=wd(a.A(),a.A().b,T(b).b),c=a.o.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.o.length&&!(a.o[d].a>=T(b).b);++d);a.o[d].b<T(b).b?(c=wd(a.o[d],a.o[d].b,T(b).b),c=a.o.slice(0,d).concat([c])):(T(a).b>T(b).b||T(b),c=a.o.slice(0,d))}a.o=c.concat(b.o)}}
k.ja=function(a){var b=a-this.i;if(0==b)return 0;this.o=xd(this.o,b);this.i=a;return b};k.Ba=function(){return 0<this.length()?{start:T(this).b,end:this.A().a}:{start:0,end:0}};function U(a,b,c,d){S.call(this,a);this.g=b;this.w=c;this.f=d;this.h=this.g.b||this.g.a.reduce(function(a,b){return null==b.a?NaN:a+b.a},0)||0;this.a=this.l=this.c=null;Ad(this)}q(U,S);U.prototype.destroy=function(){this.w=this.g=null;S.prototype.destroy.call(this)};U.prototype.ka=function(a){Bd(this,w()/1E3);return S.prototype.ka.call(this,a)};U.prototype.Da=function(a){if(!(a instanceof U))return!1;zd(this,a);this.h=Math.max(this.h,a.h);null==this.c?(this.f=a.f,Ad(this)):Cd(this);return!0};
function Ad(a){Cd(a);if(0!=a.length()){a.length();var b=null!=a.A().a?a.A().a:a.A().b;if(a.g.c>a.f)a.c=b;else{var c=a.f-(a.g.c+a.w.start);0>c?a.c=b:c<Math.max(a.A().b,a.A().a||0)?(a.A(),a.c=b):a.c=c}a.l=a.A().b;a.a=T(a).b}}U.prototype.ja=function(a){a=S.prototype.ja.call(this,a);Math.min.apply(null,this.o.filter(function(a){return null!=a.a}).map(function(a){return a.a-a.b}));null!=this.c&&(this.l+=a,this.a+=a,this.c+=a);return a};U.prototype.Ba=function(){return Dd(this,w()/1E3)};
function Dd(a,b){Bd(a,b);if(null==a.c||null==a.l||null==a.a)return{start:0,end:0};var c=Number.POSITIVE_INFINITY;a.h&&(c=a.h);var d=b-a.f,e=a.c+d;null!=a.g.f&&(e=e-a.a-a.g.f,0<e&&(a.a+=e));a.a=Math.min(a.a,c);d=a.l+d;if(d<a.a)return{start:a.a,end:a.a};d=0<a.length()?null!=a.A().a?Math.min(d,a.A().a):d:a.a;d=Math.max(d,a.a);d=Math.min(d,c);return{start:a.a,end:d}}
function Bd(a,b){Cd(a);if(null!=a.g.f)if(null==a.c)a.length();else{for(var c=a.c+(b-a.f),d=0,e=0;e<a.o.length;++e){var f=null;e<a.o.length-1?f=a.o[e+1].a:(f=a.o[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.g.f)++d;else break}0<d&&a.o.splice(0,d)}}function Cd(a){if(a.h){for(var b=0,c=a.o.length-1;0<=c;--c)if(a.o[c].b>a.h)++b;else break;0<b&&a.o.splice(-b)}};function Ed(a,b,c,d,e){var f=1,g=0,h;if(a.c>d)h=null;else{var l=a.i||0,m=a.f||0;h=c.a;h=h.a/h.b;var n=d-(a.c+b.start);0>n?h=null:(m=n-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,n-=h,0>n?h=null:(l=Math.floor(n/h)*h-l,0>l&&(l=0),l=Math.floor(l/h)*h,h={Ra:m/h+1,current:(l>=m?l:m)/h+1}))}h&&(f=h.Ra,g=h.current-h.Ra+1);f=qd(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;U.call(this,f,a,b,d);this.s=c;this.v=this.b=0<this.length()?a.c+b.start+this.A().a:null;this.j=
h?h.current+1:null;this.B=e}q(Ed,U);Ed.prototype.destroy=function(){this.B=this.s=null;U.prototype.destroy.call(this)};Ed.prototype.ka=function(a){var b=w()/1E3;Fd(this,b);Bd(this,b);return S.prototype.ka.call(this,a)};Ed.prototype.Da=function(a){if(null!=this.b||!(a instanceof Ed)||null==a.b)return!1;this.b=a.b;this.v=a.v;this.j=a.j;this.f=a.f;this.h=a.h;zd(this,a);Fd(this,w()/1E3);Ad(this);return!0};Ed.prototype.ja=function(a){a=U.prototype.ja.call(this,a);null!=this.b&&(this.b+=a,this.v+=a);return a};
Ed.prototype.Ba=function(){var a=w()/1E3;Fd(this,a);return Dd(this,a)};function Fd(a,b){if(null!=a.b&&null!=a.v&&null!=a.j){var c=a.s.a,c=c.a/c.b,d=Math.floor((a.v+(b-a.f)-a.b)/c);if(0!=d){var e=qd(a.B,a.s,a.j,d);Array.prototype.push.apply(a.o,xd(e,a.i));a.b+=d*c;a.j+=d}}};function Gd(a,b,c,d,e){this.f=a;this.b=b;this.c=c;this.h=d;this.a=null;this.g=e}Gd.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null)};
Gd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.f.type)try{this.a=new Ed(this.f,this.b,this.c,this.h,this.g)}catch(a){return Promise.reject(a)}else{var b;b=this.c.a;if(b=qd(this.g,this.c,1,Math.ceil(this.b.a/(b.a/b.b)))){if(0<b.length){var c=b[b.length-1];b[b.length-1]=wd(c,c.b,this.b.a)}b=new S(b)}else b=null;this.a=b;if(!this.a)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b)}return Promise.resolve(this.a)};function Hd(a,b,c,d,e){this.c=a;this.b=b;this.g=c;this.a=null;this.h=d;this.f=e}Hd.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Hd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c&&(b=ud(a.c,a.f||1,this.b.a||0));var c=0;a.b&&a.i?c=a.b*a.i:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,l=null,m=null;a.b?(l=c+a.b,m=l/a.f):0<b.length?(l=b[f].end-(a.g||0),m=l/a.f):(m=h+this.b.a,l=m*a.f);var c=l,l=0,n=null;g.a&&(l=g.a.ma,n=g.a.end);e.push(new sd(h,m,new J(this.f,g.b,
l,n)))}"dynamic"==this.c.type?this.a=new U(e,this.c,this.b,this.h):this.a=new S(e);return Promise.resolve(this.a)};function Id(a,b,c,d,e){this.b=a;this.c=b;this.f=c;this.h=d;this.a=null;this.g=e}Id.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
Id.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=ud(a.c,a.b||1,this.c.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.b,g=b[d].end/a.b,e=rd(this.g,this.f,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.b;c.push(new sd(f-h,g-h,e))}"dynamic"==this.b.type?this.a=new U(c,this.b,this.c,this.h):this.a=new S(c);return Promise.resolve(this.a)};function Jd(a){this.b=a;this.a=null}Jd.prototype.destroy=function(){this.b=null;this.a&&(this.a.destroy(),this.a=null)};Jd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new sd(c.start_time,c.end_time,new J(null,[new K(c.url)],c.start_byte,null)))}this.b=null;this.a=new S(a);return Promise.resolve(this.a)};function Kd(){this.C=Ld++;this.id=this.D=this.H=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.N=!1;this.K=!0}var Ld=0;Kd.prototype.destroy=function(){this.H&&(this.H.destroy(),this.H=null);this.D&&(this.D.destroy(),this.D=null)};function Md(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}function Xd(){this.C=Yd++;this.id=null;this.contentType=this.lang="";this.b=!1;this.m=[];this.a=[]}var Yd=0;
Xd.prototype.destroy=function(){for(var a=0;a<this.m.length;++a)this.m[a].destroy();this.a=this.m=null};function Zd(a){for(var b=[],c=0;c<a.a.length;++c){var d=new $d;d.id=a.C;d.a=a.a[c];d.contentType=a.contentType;d.b=a.m.length?Md(a.m[0]):"";b.push(d)}return b}function ae(){this.id=null;this.start=0;this.b=null;this.a=[]}ae.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function be(){this.b=!1;this.h=this.g=this.f=null;this.c=0;this.a=[]}
be.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function $d(){this.id=0;this.a=null;this.b=this.contentType=""};function ce(a,b,c,d,e){F.call(this,a);this.c=b;this.a=new Gb(c,d,e);this.w=this.I=this.b=null;this.J=!1;this.g=null;this.l=!1;this.i=null;this.s=!1;this.h=new G;this.j=this.f=!1;this.B=0;this.L=15;this.F=!1}q(ce,F);ce.prototype.G=function(a){null!=a.initialStreamBufferSize&&(this.B=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.L=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.s=Number(a.segmentRequestTimeout))};
ce.prototype.destroy=function(){de(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.v=this.c=this.a=null};k=ce.prototype;k.na=function(){return this.b};k.Va=function(){return this.I};k.kb=function(a){this.f||a.then(function(){this.f=!0;this.g||ee(this,0)}.bind(this)).catch(function(){});return this.h};k.Ca=function(){return this.j};
k.qa=function(a,b,c){if(a!=this.b){var d=[a.H.create(),a.D.create()];Promise.all(d).then(H(this,function(d){if(this.c){var f=this.b;this.b=a;this.I=d[0];this.w=d[1];this.J=!0;this.l||(f?b&&fe(this,!0,c):ee(this,0))}})).catch(H(this,function(a){"aborted"!=a.type&&(this.f?(a=B(a),this.dispatchEvent(a)):this.h.reject(a))}))}};k.bb=function(){return fe(this,!1)};
function fe(a,b,c){a.b&&!a.l&&(a.l=!0,de(a),Ib(a.a).then(H(a,function(){var a=this.c.currentTime;if(!b&&0<Jb(this.a,a)&&0<=Ob(this.a.b,a))return Promise.resolve();if(c)return Rb(this.a,this.c.currentTime+c);this.F=!0;return Qb(this.a)})).then(H(a,function(){this.l=!1;ee(this,0)})).catch(H(a,function(a){this.l=!1;this.f?(a=B(a),this.dispatchEvent(a)):this.h.reject(a)})))}k.cb=function(a){return 0<Jb(this.a,a)&&0<=Ob(this.a.b,a)};k.ua=function(){};k.Aa=function(){return!0};
k.Cb=function(){if(this.s&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)fe(this,!0);else{this.g=null;a=this.b;var b=this.I,c=this.c.currentTime;Jb(this.a,this.s?c:c+(this.i||0))>=(this.s?Math.max(this.B,this.L):this.B)?(ge(this),ee(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=he(this,c,b))?(b=Kb(this.a,b,a.c,this.w),this.w=null,this.J&&(this.J=!1,ie(this,a)),this.j=!1,b.then(H(this,function(a){null==this.i&&(this.i=a);this.F&&0<Jb(this.a,c)&&(this.F=
!1,this.c.currentTime+=.001);ee(this,0)})).catch(H(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Qb.status)&&this.b&&ee(this,5E3);a=B(a);this.dispatchEvent(a)}}))):(ge(this),this.f&&!this.j&&(this.j=!0,je(this)),ee(this,1E3))}}};function he(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.ka(a.a):null:c.ka(b)||(c.length()?c.A():null)}
function ge(a){if(!a.s&&null!=a.i){a.s=!0;var b=a.a,c=a.i,d=c-b.w;0!=d&&(b.b=xd(b.b,d),b.w=c);a.h.resolve(a.i)}}function ie(a,b){var c;c=b.a.split("/")[0];c=A({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function je(a){var b=A({type:"ended"});a.dispatchEvent(b)}function ee(a,b){a.g=window.setTimeout(a.Cb.bind(a),b)}function de(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function ke(a){this.b=a;this.a=null}ke.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};ke.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new sd(0,null,this.b);this.a=new S([a]);return Promise.resolve(this.a)};function le(a,b){F.call(this,a);this.b=b;this.h=!0;this.g=this.f=null;this.c=new G;this.a=null}q(le,F);le.prototype.G=function(){};le.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.v=this.b=this.f=this.g=this.a=this.c=null};k=le.prototype;k.na=function(){return this.f};k.Va=function(){return this.g};k.kb=function(){return this.c};k.Ca=function(){return!0};
k.qa=function(a){a.H.create().then(H(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.g=b;b=T(b).url.b[0].toString();var d=this.Aa();this.a&&(this.ua(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.ua(d);b=A({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};k.bb=function(){};
k.cb=function(){return!0};k.ua=function(a){this.h=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};k.Aa=function(){return this.h};function me(){}
me.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new Na(b);if(440786851!=z(g).id)f=null;else{var h=z(g);if(408125543!=h.id)f=null;else{var l=h.a.byteOffset,m;var n=new Na(h.a);for(b=null;Ja(n.a);){var t=z(n);if(357149030==t.id){b=t;break}}if(b){for(var C=new Na(b.a),n=1E6;Ja(C.a);){var u=z(C);if(2807729==u.id){n=Sa(u);break}}m=n/1E9}else m=null;f=m?{Ib:l,Nb:m}:null}}if(f){var v=z(new Na(a));if(475249515!=v.id)e=null;else{var ta=f.Ib,Db=f.Nb;a=[];var Nd=new Na(v.a);for(f=v=-1;Ja(Nd.a);){var Od=
z(Nd);if(187==Od.id){var Ia;var Pd=new Na(Od.a),Qd=z(Pd);if(179!=Qd.id)Ia=null;else{var bf=Sa(Qd),Rd=z(Pd);if(183!=Rd.id)Ia=null;else{for(var Sd=new Na(Rd.a),l=0;Ja(Sd.a);){var Td=z(Sd);if(241==Td.id){l=Sa(Td);break}}Ia={Pb:bf,Hb:l}}}if(Ia){var Ud=Db*Ia.Pb,Vd=ta+Ia.Hb;if(0<=v){var Ic=new J(d,c,f,Vd-1);a.push(new sd(v,Ud,Ic))}v=Ud;f=Vd}}}0<=v&&(Ic=new J(d,c,f,null),a.push(new sd(v,null,Ic)));e=a}}else e=null}catch(Wd){if(!(Wd instanceof RangeError))throw Wd;}return e};function ne(a,b,c,d,e,f,g){this.g=a;this.j=b;this.f=c;this.a=d;this.c=e;this.v=f;this.i=this.b=null;this.h=g}ne.prototype.destroy=function(){this.h=this.j=this.g=null;this.a.g();this.a=null;this.c&&(this.c.g(),this.c=null);this.i&&(this.i.destroy(),this.i=null);this.b=null};
ne.prototype.create=function(){if(this.b)return this.b;var a=[Nb(this.a)];"webm"==this.f&&a.push(Nb(this.c));return this.b=Promise.all(a).then(H(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new yd,d=d.parse(new DataView(c),this.a.f,this.a.b,this.h)):"webm"==this.f&&(d=new me,d=d.parse(new DataView(c),new DataView(a),this.a.b,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new U(d,this.g,this.j,this.v):e=new S(d);return Promise.resolve(e)}))};function oe(a){this.a=a}
function pe(a,b,c){for(var d=w()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var l=0;l<h.a.length;++l){var m=h.a[l],n=0,n=n+(m.g?1:0),n=n+(m.b?1:0),n=n+(m.a?1:0);0==n?(h.a.splice(l,1),--l):1!=n&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}qe(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){l=h=f.b[g];m=null;for(n=0;n<l.a.length;++n){var t=l.a[n].f||"";m?t!=m&&(l.a.splice(n,1),--n):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.c&&(b.c=d);e=new be;"dynamic"==b.type&&(e.b=!0,e.f=b.g,e.g=new J(c,b.j||b.url),e.h=b.c);e.c=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=re(a,b,g,d,c);e.a.push(g)}return e}
function qe(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.b=null);b(a.b)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.b);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.b};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.b)||(e=a.a[a.a.length-1],d?a.b=c:b(e.start)&&b(e.a)?a.b=e.start+e.a:"dynamic"!=a.type&&
(a.b=c))}}function re(a,b,c,d,e){var f=new ae;f.id=c.id;f.start=c.start;f.b=c.a;var g=new D;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=hb(g),l=0;l<h.length;++l){var m=new D;g.get(h[l]).forEach(function(a){m.push(a.group,a)});for(var n=hb(m),t=0;t<n.length;++t){var C=new D;m.get(n[t]).forEach(function(a){C.push(a.lang,a)});for(var u=hb(C),v=0;v<u.length;++v){var ta=C.get(u[v]),ta=se(a,b,c,ta,d,e);f.a.push(ta)}}}return f}
function se(a,b,c,d,e,f){ba(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new Xd,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},l=0;l<d.length;++l)for(var m=d[l],n=0;n<m.a.length;++n){var t=m.a[n],C=te(a,t),u=g.a.slice(0);
ue(C,u);0==u.length&&0<g.a.length||!(t=ve(b,c,t,e,f))||(g.m.push(t),g.a=u,h[t.C]=m)}if(g.a.some(function(a){return""==a.a}))return g.m.forEach(function(a){a.N=!0}),g;a=we(d);for(l=0;l<g.m.length;++l)t=g.m[l],m=h[t.C],m==a&&(t.N=!0);return g}function we(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function ue(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.j==g.j&&f.v==g.v&&f.h==g.h&&f.i==g.i&&f.g==g.g&&f.s==g.s&&f.f==g.f&&f.l==g.l&&Qa(f.c,g.c)){d=!0;break}}d||(b.splice(c,1),--c)}}function te(a,b){var c=[];if(0==b.c.length)c.push(new Xb);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,xe(a,b.c[d]));return c}
function xe(a,b){var c=[];if(2!=a.a.length)return[];var d=a.a(b.c||"",b.f);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=Yb(d[e]);0==f.b.length&&b.a&&b.a.psshBox&&Zb(f,[{initData:b.a.psshBox,initDataType:"cenc"}]);c.push(f)}return c}
function ve(a,b,c,d,e){if(!c.u||0===c.u.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new Pc,h.url=c.u,h.a=g.a?g.a.clone():null),h=ye(h,e),g=g.c?ye(g.c,e):null,a=new ne(a,b,f,h,g,d,e),b=new vd(g),d=new Kd,d.H=a,d.D=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?ye(f.h,e):null,a=new Hd(a,b,c,d,e),b=
new vd(f),d=new Kd,d.H=a,d.D=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.a?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.a=null):f.c&&(f.a=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?ze(c,f,Qc):null,!g)){f=null;break a}f=g?ye(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?rd(e,c,1,0)?(h=(h=c.a.f)?ze(c,h,Pc):null)?(h=ye(h,e),a=new ne(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new Id(a,b,c,d,e):g.a?"dynamic"!=a.type&&null==b.a?null:
new Gd(a,b,c,d,e):null:null;a?(b=new vd(f),d=new Kd,d.H=a,d.D=b,f=d):f=null}else f=null;g=c.a.b;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new Kd,f.H=new ke(new J(e,c.u)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.b&&f.f.push(b.b);return f}function ze(a,b,c){b=td(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=md(a.u,b);return c}
function ye(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.ma,e=a.a.end);return new J(b,c,d,e)};function Ae(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function Be(a,b){var c=new Ce(b);a.streamHistory.push(new De(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function Ce(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function De(a){this.timestamp=w()/1E3;this.value=a};function Ee(a,b){sb.call(this,"readwrite",b);this.j=a;this.b=0}q(Ee,sb);
function Fe(a,b,c,d,e){for(var f=[],g=[],h=0,l=0,m=[],n=b.map(function(a){return a.H.create()}),n=Promise.all(n),t=b.map(function(a){return a.D.create()}),t=Promise.all(t),n=Promise.all([n,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)n=n.then(function(a){return Ge(this,b[a],f[a],g[a],h,l)}.bind(a,t)),n=n.then(function(a,b){l+=f[a].length();m.push(b)}.bind(a,t));return n.then(H(a,function(){return He(yb(this))})).then(H(a,function(a){var b=
new G;c=Ea(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a,license_server:e.j,with_credentials:e.v,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.l},g=yb(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function Ie(a,b){return zb(yb(a),b).then(H(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(Je(this,a.stream_ids[e]));a=yb(this);d.push(a.delete(b));return Promise.all(d)}))}
function Ge(a,b,c,d,e,f){var g=[He(xb(a)),He(vb(a).index("stream"))],g=Promise.all(g).then(H(a,function(a){return{pa:Math.max(a[0],a[1]),ia:new ArrayBuffer(0),Ea:0,o:[],za:null,Ob:e,ab:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function He(a){var b=new G,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
Ee.prototype.g=function(a,b,c){var d=new G;a={stream_id:c.pa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.o};var e=xb(this).put(a);e.onsuccess=function(){d.resolve(c.pa)};e.onerror=function(){d.reject(e.error)};return d};Ee.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(H(this,function(a){Je(this,b.pa);return Promise.reject(a)}))};
Ee.prototype.c=function(a,b,c,d){var e=new G;0==b.ia.byteLength&&(b.za=a);b.ia=Ke(b.ia,d);b.ab++;var f=A({type:"progress",detail:b.ab/b.Ob*100,bubbles:!0});if(1048576<=b.ia.byteLength||c){c={stream_id:b.pa,segment_id:b.Ea,content:b.ia};var g=vb(this).put(c);b.o.push({start_time:b.za.b,start_byte:b.za.url.f,end_time:a.a,url:"idb://"+b.pa+"/"+b.Ea});b.Ea++;b.ia=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=H(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function Ke(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}Ee.prototype.i=function(a){var b=new Mb;b.c=1E3*this.b;return Nb(a.url,b,this.j)};
function Je(a,b){var c=new G,d=xb(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=vb(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function Le(a,b,c,d,e,f){this.b=new J(null,[new K(a)]);this.a=new Mb;this.a.body=b;this.a.method=c;this.a.a=3;this.a.j=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}function Me(a){return Nb(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function Ne(a,b,c){F.call(this,a);this.g=b;this.b=c;this.a=this.i=null;this.l=new ib;this.h=[];this.f=[];this.s=0;this.c=new G;this.j=null;this.w=0}q(Ne,F);Ne.prototype.destroy=function(){this.v=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.h=this.a=this.i=null;this.c.destroy();this.c=null;this.l.destroy();this.l=null;this.j&&(window.clearTimeout(this.j),this.j=null);this.g=this.b=null};
Ne.prototype.initialize=function(){for(var a=new D,b=this.b.Ua(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!Oe(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.s||this.b.ga()?"required":"optional",sessionTypes:[this.b.ga()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var l;"audio"==f.contentType?l=f.a.f:"video"==f.contentType&&(l=f.a.l);h[g].push({contentType:f.b,robustness:l})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.Fa(a),this.c.resolve(),Promise.resolve();l=new G;c=Pe(this,c,l);c=c.then(this.lb.bind(this,b,a));c=c.then(this.Jb.bind(this));l.reject(null);return c};
function Qe(a,b){null==a.j&&(a.j=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.c.reject(a)}.bind(a),b));return a.c}function Re(a){return Promise.all(a.f.map(function(a){return a.remove()}))}
function Pe(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.ga()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}k=Ne.prototype;
k.lb=function(a,b,c){if(!this.g)return Se();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var l=e[h+"Capabilities"];if(l&&l.length){for(var l=l[0],m=[],n={},t=0;t<a.length;++t){var C=a[t];if(C.a.a==d&&C.b==l.contentType&&!(C.id in n)){m.push(C);n[C.id]=!0;var u;if(this.a){u=this.a;var C=C.a,v=new Xb;v.a=u.a;v.j=u.j;v.v=u.v;v.h=u.h;v.i=u.i;v.g=u.g;v.s=u.s;v.f=u.f;v.l=u.l;v.c=u.c?new Uint8Array(u.c.buffer):null;Zb(v,u.b);Zb(v,
C.b);u=v}else u=C.a;this.a=u}}b.a[h]=m}}}this.b.Fa(b);return c.createMediaKeys()};
k.Jb=function(a){if(!this.g)return Se();this.i=a;return this.g.setMediaKeys(this.i).then(H(this,function(){return this.g?this.a.c?this.i.setServerCertificate(this.a.c):Promise.resolve():Se()})).then(H(this,function(){if(!this.g)return Se();if(0<this.b.ta().length)Te(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.Wa({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&E(this.l,this.g,"encrypted",this.Wa.bind(this))}}))};
function Se(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}
k.Wa=function(a){for(var b=new Uint8Array(a.initData),c=0;c<this.h.length;++c)if(Qa(b,this.h[c]))return;try{var d=Ue(this)}catch(e){d=B(e);this.dispatchEvent(d);this.c.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.h.push(b);a.catch(H(this,function(a){if(this.g){for(var c=0;c<this.h.length;++c)if(Qa(b,this.h[c])){this.h.splice(c,1);break}c=B(a);this.dispatchEvent(c);this.c.reject(a)}}));this.f.push(d)};
function Te(a){for(var b=a.b.ta(),c=0;c<b.length;++c){var d=Ue(a),e=d.load(b[c]);a.f.push(d);e.then(H(a,function(){this.s++;this.s>=this.f.length&&this.c.resolve()})).catch(H(a,function(a){a=B(a);this.dispatchEvent(a)}))}}
function Ue(a){var b=null;if(a.b.ga())try{b=a.i.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.i.createSession();E(a.l,b,"message",a.yb.bind(a));E(a.l,b,"keystatuseschange",a.qb.bind(a));return b}k.yb=function(a){Ve(this,a.target,this.a,a.message)};k.qb=function(a){a=a.target.keyStatuses;for(var b={},c=a.keys(),d=c.next();!d.done;d=c.next()){var e=Wb(new Uint8Array(d.value)),d=a.get(d.value);b[e]=d}this.b.Xa(b)};
function Ve(a,b,c,d){d=We(c,d);Me(new Le(d.url,d.body,d.method,c.v,d.headers,a.w)).then(H(a,function(a){c.h&&(a=c.h(a));return b.update(a)})).then(H(a,function(){var a=A({type:"sessionReady",detail:b});this.dispatchEvent(a);this.s++;this.s>=this.f.length&&this.c.resolve()})).catch(H(a,function(a){a.Sb=b;a=B(a);this.dispatchEvent(a)}))}
function We(a,b){var c={url:a.j,body:b.slice(0),method:"POST",headers:{}};if(!a.i)return c;a.i(c);c.url=db(c,"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=db(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=eb(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");
return c};function V(a){F.call(this,null);this.a=a;this.b=null;this.f=new ib;this.i=this.j=null;this.F=0;this.w=null;this.h=!1;this.g=new Ae;this.c={enableAdaptation:!0,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new ja};this.l=1;this.G=null}q(V,F);p("shaka.player.Player",V);V.version="v1.5.0-29-g5637962";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function Oe(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=Oe;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+oa(a)+" }",0)};V.prototype.destroy=function(){return this.s().then(H(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.s=function(){if(!this.b)return Promise.resolve();this.h&&Xe(this);this.a.pause();jb(this.f);Ye(this);Ze(this);this.j&&(this.j.destroy(),this.j=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.h=!1;this.g=new Ae;return a};V.prototype.unload=V.prototype.s;
V.prototype.ca=function(a){var b=this.s();this.a.autoplay&&(da("load"),E(this.f,this.a,"timeupdate",this.pb.bind(this)));a.S(this.c);a.hb(this.G);this.G=null;b=b.then(H(this,function(){return a.V()}));b.catch(H(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(H(this,function(){if(!this.a)return $e();this.b=a;E(this.f,this.b,"seekrangechanged",this.wb.bind(this));this.j=new Ne(this,this.a,this.b);return this.j.initialize()})).then(H(this,function(){if(!this.a)return $e();E(this.f,
this.a,"error",this.Kb.bind(this));E(this.f,this.a,"playing",this.ub.bind(this));E(this.f,this.a,"pause",this.tb.bind(this));return this.b.Oa(this,this.a)})).then(H(this,function(){if(!this.a)return $e();af(this)})).catch(H(this,function(a){if(!this.a)return $e();if("destroy"!=a.type){var b=B(a);this.dispatchEvent(b)}return this.s().then(function(){return Promise.reject(a)})}))};V.prototype.load=V.prototype.ca;
function $e(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}k=V.prototype;k.pb=function(){ga("load");this.g.playbackLatency=ha("load")/1E3;this.f.ra(this.a,"timeupdate")};k.Kb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(cf[a]||"Unknown playback error."),a.type="playback",a=B(a),this.dispatchEvent(a))}};
k.ub=function(){da("playing");!this.i&&0>this.l&&(this.a.playbackRate=0,this.B(this.a.currentTime,Date.now(),this.l));this.h&&Xe(this)};k.tb=function(){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}Ze(this)};k.wb=function(a){this.F=a.start};
k.ib=function(){if(!this.a.paused){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;da("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.ib;V.prototype.Z=function(){return this.b?this.b.la():[]};V.prototype.getVideoTracks=V.prototype.Z;V.prototype.W=function(){return this.b?this.b.oa():[]};
V.prototype.getAudioTracks=V.prototype.W;V.prototype.Y=function(){return this.b?this.b.Ha():[]};V.prototype.getTextTracks=V.prototype.Y;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.da=function(a,b){return this.b?this.b.fb(a,void 0==b?!0:b):!1};V.prototype.selectAudioTrack=V.prototype.da;V.prototype.M=function(a){return this.b?this.b.gb(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.M;V.prototype.U=function(a){this.b&&this.b.Ga(a)};V.prototype.enableTextTrack=V.prototype.U;V.prototype.S=function(a){Ze(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.B(this.a.currentTime,Date.now(),a));this.l=a};V.prototype.setPlaybackRate=V.prototype.S;V.prototype.J=function(){return this.l};V.prototype.getPlaybackRate=V.prototype.J;V.prototype.ea=function(a){this.G=a};V.prototype.setPlaybackStartTime=V.prototype.ea;
V.prototype.I=function(){return this.b?this.b.eb():!1};V.prototype.isLive=V.prototype.I;
V.prototype.T=function(a){if(a){var b=cb(a,"enableAdaptation","boolean");null!=b&&(this.c.enableAdaptation=b);b=bb(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=bb(a,"liveStreamEndTimeout");null!=b&&(this.c.liveStreamEndTimeout=b);b=bb(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=bb(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=bb(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=db(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=
b);a=eb(a,"restrictions",ja);null!=a&&(this.c.restrictions=a.clone());this.b&&this.b.S(this.c)}};V.prototype.configure=V.prototype.T;V.prototype.X=function(){return this.c};V.prototype.getConfiguration=V.prototype.X;function Ze(a){a.i&&(window.clearTimeout(a.i),a.i=null)}function af(a){Ye(a);a.w=window.setTimeout(a.L.bind(a),100)}function Ye(a){a.w&&(window.clearTimeout(a.w),a.w=null)}
V.prototype.B=function(a,b,c){this.i=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.F+(this.I()?1:.05)?this.a.pause():(d=Math.max(this.F,a+d),this.a.currentTime=d,this.i=window.setTimeout(this.B.bind(this,a,b,c),250))};function Xe(a){ga("buffering");var b=a.g;b.bufferingTime+=ha("buffering")/1E3;a.h=!1;a.dispatchEvent(A({type:"bufferingEnd"}))}
V.prototype.L=function(){af(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0),c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;if(this.h){if(c=this.b.Ta(),b||a>c)Xe(this),this.a.play()}else!this.a.paused&&!b&&.2>a&&(this.h=!0,this.a.pause(),this.g.bufferingHistory.push(w()/1E3),da("buffering"),this.dispatchEvent(A({type:"bufferingStart"})))}};
var cf={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function df(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.m.length;++g)Oe(Md(f.m[g]))||(f.m.splice(g,1),--g);0==e.m.length&&(c.a.splice(d,1),--d)}}function ef(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].m.sort(ff)}function ff(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function gf(a){this.a=a}gf.prototype.destroy=function(){this.a.destroy();this.a=null};function hf(a,b){var c=jf(b),d=jf(a.a);return Promise.all([c,d]).then(H(a,function(a){var c=a[0];a=a[1];var d=this.a.a;df(d);ef(d);b.f=this.a.f;b.g=this.a.g?this.a.g.clone():null;b.c=this.a.c;d=[];kf(b,this.a,c,a,d);c=b.a;df(c);ef(c);return Promise.resolve(d)}))}
function jf(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.m}).reduce(b,[]);a=c.map(function(a){return a.H.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].C]=a[f];return Promise.resolve(b)})}
function kf(a,b,c,d,e){var f=new D;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=hb(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(lf(l[0],h[0],c,d,e),l[0].b=h[0].b)}}
function lf(a,b,c,d,e){var f=new D;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=hb(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&mf(l[0],h[0],c,d,e)}}
function mf(a,b,c,d,e){var f=new D;a.m.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.m.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=hb(f),l=0;l<h.length;++l){var m=h[l];b[m]=m;var n=f.get(m);1<n.length||((m=g.get(m))&&0!=m.length?1==m.length&&(nf(n[0],m[0],c,d),n[0].D=m[0].D,m[0].D=null,n[0].c=m[0].c):(e.push(n[0]),a.m.splice(a.m.indexOf(n[0]),1)))}h=hb(g);for(l=0;l<h.length;++l)m=h[l],b[m]||(b[m]=m,m=g.get(m),a.m.push(m[0]))}
function nf(a,b,c,d){a=c[a.C];b=d[b.C];a.length();a.Da(b)&&a.length()};function W(){this.a=this.b=null;this.f=new ib;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}p("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,E(this.f,this.b,"bandwidth",this.v.bind(this)),E(this.f,this.a,"adaptation",this.j.bind(this)),E(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=of(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.v=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=of(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function of(a){var b=a.a.la();if(0==b.length)return null;b.sort(sa);var c;a:{c=a.a.oa();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function pf(a,b,c){F.call(this,null);this.f=a;this.c=b;this.b=Yb(c);this.a=null}q(pf,F);p("shaka.player.HttpVideoSource",pf);pf.prototype.S=function(){};pf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.v=this.b=null};k=pf.prototype;k.Oa=function(a,b){this.v=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};k.V=function(){return Promise.resolve()};
k.la=function(){return[]};k.oa=function(){return[]};k.Ha=function(){return[]};k.Ta=function(){return 5};k.Ua=function(){var a=new $d;a.a=this.b;return[a]};k.Fa=function(){};pf.prototype.selectVideoTrack=function(){return!1};k=pf.prototype;k.fb=function(){return!1};k.gb=function(){return!1};k.Ga=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};k.hb=function(){};k.ta=function(){return[]};k.ga=function(){return!1};k.eb=function(){return!1};
k.Xa=function(a){for(var b in a){var c=a[b],d=Ta[c]||null;if(d){var e=nb(b),d=Error("Key "+e+" is not usable. "+d);d.type="drm";d.code=c;c=B(d);this.dispatchEvent(c)}}};function X(a,b,c){F.call(this,null);this.a=a;this.Y=b;this.h=new ib;this.g=new MediaSource;this.f=null;this.ca=0;this.b=new D;this.I=c;this.I.initialize(b,this);this.L=!1;this.J="en";this.ea=!1;this.T=null;this.B=new G;this.i=new ja;this.F=null;this.Na=1;this.c={};this.da=new G;this.La=this.W=0;this.Ma=15;this.w=null;this.Ka=!1;this.s={};this.Z=this.X=this.U=null;this.G={}}q(X,F);p("shaka.player.StreamVideoSource",X);
X.prototype.S=function(a){null!=a.streamBufferSize&&(this.G.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.G.segmentRequestTimeout=a.segmentRequestTimeout);qf(this);null!=a.enableAdaptation&&this.I.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.ca=Number(a.mpdRequestTimeout));null!=a.liveStreamEndTimeout&&(this.Ma=Number(a.liveStreamEndTimeout));null!=a.preferredLanguage&&(this.J=Xa(String(a.preferredLanguage)));null!=a.restrictions&&(this.i=a.restrictions,
this.L&&rf(this))};X.prototype.destroy=function(){this.B.destroy();this.da.destroy();this.da=this.B=null;this.X&&(window.clearTimeout(this.X),this.X=null);this.U&&(window.clearTimeout(this.U),this.U=null);this.s=null;this.h.destroy();this.h=null;ab(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.I.destroy();this.v=this.i=this.T=this.f=this.g=this.Y=this.I=null};k=X.prototype;
k.Oa=function(a,b){if(!this.L){var c=Error("Cannot call attach() right now.");c.type="app";return Promise.reject(c)}this.v=a;this.f=b;this.T=a.ib();E(this.h,this.g,"sourceopen",this.sb.bind(this));E(this.h,this.Y,"bandwidth",this.Lb.bind(this));this.a.b&&(E(this.h,a,"bufferingStart",this.ob.bind(this)),E(this.h,a,"bufferingEnd",this.nb.bind(this)));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.B,c])};
k.V=function(){if(this.L){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;df(a);ef(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.L=!0;this.G.initialStreamBufferSize=this.a.c;qf(this);rf(this);
return Promise.resolve()};k.$a=function(a){var b=Date.now(),c=this.U=null,d=this.a.g;(a?this.Ya():this.Za(d)).then(H(this,function(a){c=new gf(a);return hf(c,this.a)})).then(H(this,function(a){c.destroy();c=null;for(var d=0;d<a.length;++d)sf(this,a[d]);this.G.initialStreamBufferSize=this.a.c;qf(this);rf(this);0==Object.keys(this.c).length?tf(this):uf(this,(Date.now()-b)/1E3)})).catch(H(this,function(a){c&&(c.destroy(),c=null);"aborted"!=a.type&&(a=B(a),this.dispatchEvent(a),this.a&&uf(this,0))}))};
k.Za=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};k.Ya=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};function uf(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.U=window.setTimeout(a.$a.bind(a,!1),1E3*c)}}
function sf(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.na()==b){var e=a.b.get(b.a.split("/")[0]),f=e.map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.N&&a.K});if(0==f.length){e.push(b);return}a.s[c].Ia==b&&delete a.s[c];d.qa(f[0],!0);b.destroy()}b.destroy()}
k.la=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.na():null)?a.C:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.m.length;++f){var g=e.m[f];if(g.N&&g.K){var h=g.C,g=new ra(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.la;
X.prototype.oa=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.na():null)?a.C:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.m.length;++g){var h=e.m[g];if(h.N&&h.K){var l=h.C,h=new ia(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.oa;
X.prototype.Ha=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.na():null,b=b?b.C:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.m.length;++h){var l=f.m[h].C,m=new qa(l,g);l==b&&(m.active=!0,m.enabled=a.Aa());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Ha;X.prototype.Ta=function(){return Number(this.G.initialStreamBufferSize)};
X.prototype.Ua=function(){var a;if(this.L){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,Zd(a.a[c]));a=b}else a=[];return a};
X.prototype.Fa=function(a){if(this.L){for(var b={},c=this.a.a[0],d=0;d<c.a.length;++d){var e=c.a[d];b[e.C]=e}this.b.a={};c=hb(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var l=f[h];l.b.split(";")[0]==g&&this.b.push(e,b[l.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.ea=!0;if(a=this.b.get("audio"))vf(this,a),this.b.a.audio=a,a=a[0].lang||this.J,Wa(2,this.J,
a)&&(this.ea=!1);if(a=this.b.get("text"))vf(this,a),this.b.a.text=a,a=a[0].lang||this.J,Wa(2,this.J,a)||(this.ea=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return wf(this,"video",a,b,c)};k=X.prototype;k.fb=function(a,b){return wf(this,"audio",a,b)};k.gb=function(a,b){return wf(this,"text",a,b)};k.Ga=function(a){var b=this.c.text;b&&b.ua(a)};k.hb=function(a){this.Z=a};
function rf(a){if(a.i){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.m.length;++g){var h=f.m[g],l=h.K;h.K=!0;a.i.maxWidth&&h.width>a.i.maxWidth&&(h.K=!1);a.i.maxHeight&&h.height>a.i.maxHeight&&(h.K=!1);a.i.maxBandwidth&&h.bandwidth>a.i.maxBandwidth&&(h.K=!1);a.i.minBandwidth&&h.bandwidth<a.i.minBandwidth&&(h.K=!1);l!=h.K&&(b=!0)}}0!=fb(a.b).length&&b&&(xf(a),0<a.la().length||(b=Error("The application has restricted all video tracks!"),
b.type="app",b=B(b),a.dispatchEvent(b)))}}k.ta=function(){return[]};k.ga=function(){return!1};k.eb=function(){return this.a?this.a.b:!1};
k.Xa=function(a){for(var b,c=!1,d=new D,e=fb(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.m.length;++h){var l=g.m[h];l.f.forEach(function(a){d.push(a,l)})}for(b in a)if(e=Ta[a[b]]||null,g=d.get(b))for(f=0;f<g.length;++f)l=g[f],h=l.N,l.N=!e,h!=l.N&&(c=!0);else nb(b);c&&(xf(this),b=this.oa(),a=this.la(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":b?"audio tracks.":
"video tracks.")),a.type="drm",a=B(a),this.dispatchEvent(a))};function xf(a){var b=A({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function wf(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.m.length;++l){var m=h.m[l];if(m.C==c){if(!m.N||!m.K)return!1;if("text"!=b&&!a.Ka)return c=a.s[b],a.s[b]={Ia:m,Pa:null!=c&&c.Pa||d,Qa:null!=c&&c.Qa||e},!0;Be(a.T,m);a.c[b].qa(m,d,e);return!0}}return!1}
function vf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Wa(c,a.J,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}k.sb=function(){this.h.ra(this.g,"sourceopen");tf(this).then(H(this,function(){this.B&&this.B.resolve()})).catch(H(this,function(a){this.B&&this.B.reject(a)}))};
function tf(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=yf(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=ab(f).map(function(a){return a.H.create()});return Promise.all(b).then(H(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=zf(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Af(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.I.start();Bf(this,f,a);return Promise.resolve()})).catch(H(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(w()<this.a.h?(a=Math.max(this.a.h-Date.now()/1E3,3),this.U=window.setTimeout(this.$a.bind(this,
!0),1E3*a)):uf(this,0),Promise.resolve()):Promise.reject(a)}))}function yf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.I.getInitialVideoTrackId();if(null==g)continue;f=e.m.filter(function(a){return a.C==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.m.filter(function(a){return a.N&&a.K});if(0==f.length)continue;f=e.m[Math.floor(f.length/2)]}else 0<e.m.length&&(f=e.m[0]);c[e.contentType]=f}return c}
function Af(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new le(a,a.f):Cf(a,e);if(!e)return ab(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function Cf(a,b){var c=new ce(a,a.f,a.g,Md(b),a.Y);c.G(a.G);return c}
function Bf(a,b,c){a.Na=a.f.playbackRate;a.f.playbackRate=0;Df(a,c);var d;d=a.a.b?c.end:a.Z&&a.Z<=c.end&&a.Z>=c.start?a.Z:c.start;E(a.h,a.f,"seeking",a.xb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.F=d);Ef(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.kb(a.da));E(a.h,d,"ended",a.zb.bind(a));var f=b[e];Be(a.T,f);d.qa(f,!1)}Promise.all(c).then(a.mb.bind(a)).catch(H(a,function(a){"destroy"!=a.type&&(a=B(a),this.dispatchEvent(a))}));a.Ga(a.ea)}
k.mb=function(a){ba(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=Ff(this);for(d=0;d<a.length;++d)a[d].ja(c);Gf(this,a,c);d=fb(this.b).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.H.create()];a.D&&b.push(a.D.create());return Promise.all(b)});Promise.all(d).then(H(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ja(c);this.Ka=
!0;for(var d in this.s)a=this.s[d],b=this.c[d],Be(this.T,a.Ia),b.qa(a.Ia,a.Pa,a.Qa);this.s={}})).catch(H(this,function(a){"aborted"!=a.type&&(a=B(a),this.dispatchEvent(a))}))};function Gf(a,b,c){if(b=zf(a,b))Df(a,b),Ef(a,b.start,b.end);0!=c?(c=a.f.currentTime+c,a.f.currentTime=c,a.F=c):c=a.f.currentTime;a.a.b&&b&&(a.W=b.end-c,a.W=Math.max(a.W,0));a.f.playbackRate=a.Na;a.a.b&&null!=a.a.f&&uf(a,a.W);Hf(a);a.da.resolve()}
function Df(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}k.Bb=function(){this.X=null;Hf(this);var a=zf(this,Ff(this));a&&(this.a.b&&this.La!=a.A&&(this.La=a.A,null!=this.w&&(window.clearTimeout(this.w),this.w=null)),Ef(this,a.start,a.end),this.f.paused||If(this,this.f.currentTime,a.start,a.end))};
function Ef(a,b,c){b=A({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}k.xb=function(){var a=this.f.currentTime;if(null!=this.F){if(a>=this.F-.01&&a<=this.F+.01){this.F=null;return}this.F=null}var b=zf(this,Ff(this));if(b){var c=b.end;(b=If(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].bb()}};
function If(a,b,c,d){if(b>=c-.01)return!1;b=0;if(a.a.b){b=.5;for(var e in a.c)if(!a.c[e].cb(c+b)){b=a.a.c;break}}a.f.currentTime=Math.min(c+b,d);return!0}k.zb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].Ca())return;this.Sa()}};k.ob=function(){ab(this.c).every(function(a){return a.Ca()})&&(this.w=window.setTimeout(this.Sa.bind(this),1E3*this.Ma))};k.nb=function(){null!=this.w&&(window.clearTimeout(this.w),this.w=null)};
k.Lb=function(){var a=this.T,b=this.Y.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new De(b))};k.Sa=function(){this.w=null;this.g.endOfStream()};function Ff(a){return ab(a.c).map(function(a){return a.Va()}).filter(function(a){return null!=a})}
function zf(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,f=0;f<b.length;++f){var g=b[f].Ba(),c=Math.max(c,g.start);null!=g.end&&(d=Math.min(d,g.end));b[f].length()&&(e=Math.min(e,b[f].A().a))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-(a.a.c+a.W),c));return c>d?null:{start:c,end:d,A:e}}function Hf(a){a.a.b&&(a.X=window.setTimeout(a.Bb.bind(a),1E3))}function qf(a){for(var b in a.c)a.c[b].G(a.G)};function Y(a,b,c,d){c||(c=new mb);d||(d=new W);X.call(this,null,c,d);this.xa=a;this.l=null;this.M=b;this.$=[];this.fa=[];this.sa=[];this.j=null}q(Y,X);p("shaka.player.DashVideoSource",Y);Y.prototype.ya=function(a,b,c){this.$.push(a);this.fa.push(b||"");this.sa.push(c||"")};Y.prototype.addExternalCaptions=Y.prototype.ya;Y.prototype.va=function(a){this.j=a};Y.prototype.setNetworkCallback=Y.prototype.va;Y.prototype.destroy=function(){this.l=this.j=this.M=null;X.prototype.destroy.call(this)};
Y.prototype.V=function(){var a=new J(this.j,[new K(this.xa)]);return pd(new od(a,this.ca)).then(H(this,function(a){this.l=a;for(var c=0;c<this.$.length;c++){var d=a,e=this.$[c],f=this.fa[c],g=this.sa[c];if(0!==d.a.length){var h=new Ec;h.contentType="text";h.lang=f||"en";h.c=!0;f=new Hc;f.bandwidth=0;f.f=g||"text/vtt";f.u=[new K(e)];h.a.push(f);d.a[0].b.push(h);ad(d.a[0])}}this.a=pe(new oe(this.M),a,this.j);return X.prototype.V.call(this)}))};
Y.prototype.Za=function(a){return pd(new od(a,this.ca)).then(H(this,function(a){this.l=a;a=pe(new oe(this.M),a,this.j);return Promise.resolve(a)}))};Y.prototype.Ya=function(){var a=pe(new oe(this.M),this.l,this.j);return Promise.resolve(a)};function Z(a,b,c){b||(b=new mb);c||(c=new W);X.call(this,null,b,c);this.$=a;this.M=[];this.timeoutMs=3E4;this.l={};this.j=this.fa=null}q(Z,X);p("shaka.player.OfflineVideoSource",Z);Z.prototype.S=function(a){null!=a.licenseRequestTimeout&&(this.l.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.l.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.S.call(this,a)};
p("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Ab,b=tb(a).then(function(){return Bb(a)});b.then(function(){I(a)}).catch(function(){I(a)});return b});
Z.prototype.va=function(a,b,c,d){var e,f=null,g={},h=[];a=new J(this.fa,[new K(a)]);return pd(new od(a,this.ca)).then(H(this,function(a){this.a=pe(new oe(c),a,this.fa);if(this.a.b)return a=Error("Unable to store live streams offline."),a.type="app",Promise.reject(a);this.S({preferredLanguage:b});return X.prototype.V.call(this)})).then(H(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new Ne(null,a,this);null!=this.l.licenseRequestTimeout&&(e.w=Number(this.l.licenseRequestTimeout));
E(this.h,e,"sessionReady",this.sa.bind(this));E(this.h,e,"error",function(a){f=a});return e.initialize()})).then(H(this,function(){for(var a=fb(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.m.length;++e){var f=c.m[e];g[f.C]=f}return d()})).then(H(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)h.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];h=h.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:!0});a=h.map(function(a){return a.D.create()});
return Promise.all(a)})).then(H(this,function(a){for(var b=h,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(Md(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(H(this,function(){return Qe(e,this.timeoutMs)})).then(H(this,function(){return f?Promise.reject(f):Jf(this,h,e.a,this.a.a[0].b)})).then(H(this,function(a){this.$=a;return f?
(Kf(this),Promise.reject(f)):Promise.resolve(a)}))};p("shaka.player.OfflineVideoSource.prototype.store",Z.prototype.va);Z.prototype.ya=function(a){this.fa=a};Z.prototype.setNetworkCallback=Z.prototype.ya;Z.prototype.sa=function(a){this.M.push(a.detail.sessionId)};
function Jf(a,b,c,d){var e=new Ee(a.Y,a);null!=a.l.segmentRequestTimeout&&(e.b=Number(a.l.segmentRequestTimeout));return tb(e).then(H(a,function(){return Fe(e,b,this.M,d,c)})).then(function(a){I(e);return Promise.resolve(a)}).catch(function(a){I(e);return Promise.reject(a)})}
Z.prototype.V=function(){var a=new Ab,b,c;return tb(a).then(H(this,function(){return Cb(a,this.$)})).then(H(this,function(d){var e=[];this.M=d.session_ids;b=d.duration;c={keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f<d.stream_ids.length;++f)e.push(Eb(a,d.stream_ids[f]));return Promise.all(e)})).then(H(this,
function(a){var e=b,f=c,g=new be;g.c=5;for(var h=new ae,l=0;l<a.length;++l){var m=a[l],n=new Kd,t=new Jd(m.references),C=new vd(null,m.init_segment);n.H=t;n.D=C;n.a=m.mime_type;n.b=m.codecs;n.N=!0;this.j&&(null!=this.j.licenseServerUrl&&(f.licenseServerUrl=this.j.licenseServerUrl),null!=this.j.withCredentials&&(f.withCredentials=this.j.withCredentials),f.licensePostProcessor=this.j.licensePostProcessor,f.licensePreProcessor=this.j.licensePreProcessor,f.serverCertificate=this.j.serverCertificate);
m=Yb(f);t=new Xd;t.m.push(n);t.a.push(m);t.contentType=n.a.split("/")[0];h.a.push(t);h.b=e}g.a.push(h);this.a=g;return X.prototype.V.call(this)})).then(function(){I(a);return Promise.resolve()}).catch(function(b){I(a);return Promise.reject(b)})};
Z.prototype.xa=function(a,b){a&&(this.j={licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return Lf(this).catch(function(a){return b?(c=a,Promise.resolve()):Promise.reject(a)}).then(H(this,function(){return Kf(this)})).then(function(){return Promise.resolve(c)})};Z.prototype.deleteGroup=Z.prototype.xa;Z.prototype.ta=function(){return this.M};
Z.prototype.ga=function(){return!0};function Kf(a){var b=new Ee(null,null);return tb(b).then(H(a,function(){return Ie(b,this.$)})).then(function(){I(b);return Promise.resolve()}).catch(function(a){I(b);return Promise.reject(a)})}
function Lf(a){var b=document.createElement("video");b.src=window.URL.createObjectURL(a.g);var c=new Ne(null,b,a);null!=a.l.licenseRequestTimeout&&(c.w=Number(a.l.licenseRequestTimeout));return a.V().then(function(){return c.initialize()}).then(H(a,function(){return Qe(c,this.timeoutMs)})).then(function(){return Re(c)}).then(H(a,function(){c.destroy();this.destroy();return Promise.resolve()})).catch(H(a,function(a){c.destroy();this.destroy();return Promise.reject(a)}))};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

